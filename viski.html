<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Виски</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <a class="icon profile-icon">
                <svg fill="none" width="2em" height="2em" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path clip-rule="evenodd" d="m22 12c0 5.5228-4.4772 10-10 10-5.52285 0-10-4.4772-10-10 0-5.52285 4.47715-10 10-10 5.5228 0 10 4.47715 10 10zm-4.2863 4.4006c.3279.3345.3279.8644-.0001 1.199-1.4519 1.4813-3.4754 2.4004-5.7135 2.4004-2.23824 0-4.26176-.9191-5.71374-2.4006-.32791-.3345-.3279-.8644.00001-1.199 1.45197-1.4813 3.47544-2.4004 5.71363-2.4004 2.2382 0 4.2617.9192 5.7137 2.4006zm-5.7137-4.4006c1.6569 0 3-1.3431 3-3 0-1.65685-1.3431-3-3-3s-3 1.34315-3 3c0 1.6569 1.3431 3 3 3z" fill="#808080" fill-rule="evenodd" style="fill: #808080;"></path>
                </svg>
            </a>
        </div>
        <div class="header-center">
            <a href="index.html"><img src="7.png" alt="Perk'i Logo" class="logo"></a>
        </div>
        <div class="header-right">
            <p style="color:#ffa31a">23:00-8:00</p>
        </div>
    </header>

    <!-- Карточка профиля -->
    <div id="profile-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>Профиль</h2>
            <p>Логин: user123</p>
            <p>Баланс: 5000 ₽</p>
        </div>
    </div>

    <!-- Горизонтальное меню под шапкой -->
    <nav class="category-menu">
        <ul>
            <li><a href="index.html#strong">КРЕПКОЕ</a></li>
            <li><a href="index.html#wine">ВИНО</a></li>
            <li><a href="index.html#sparkling">ИГРИСТОЕ</a></li>
            <li><a href="index.html#liqueurs">НАСТОЙКИ</a></li>
        </ul>
    </nav>

    <!-- Карточка товара  -->
    <div class="container">
        <h1>Виски</h1>
        <div class="items">
            <div class="item-card">
                <img src="111.svg" alt="Виски Бренд 1">
                <div class="INFO">
                <h3>Jack Daniels</h3>
                <p>3000 ₽</p>
                </div>
                <div class="item-quantity-badge">0</div>
                <div class="item-controls" style="display: none;">
                    <button class="decrease-qty" >убрать</button> <!-- Скрыто по умолчанию -->
                </div>
            </div>
            <div class="item-card">
                <img src="111.svg" alt="Виски Бренд 1">
                <div class="INFO">
                <h3>Balantise</h3>
                <p>3000 ₽</p>
                </div>
                <div class="item-quantity-badge">0</div>
                <div class="item-controls" style="display: none;">
                    <button class="decrease-qty" >убрать</button> <!-- Скрыто по умолчанию -->
                </div>
            </div>
            <!-- Добавьте остальные карточки аналогично -->
        </div>
    </div>

    <!-- Кнопка View Order -->
    <div class="view-order">
        <button id="view-order-button" class="view-order-button">Корзина</button>
    </div>

    <!-- Корзина внизу -->
    <div id="order-summary" class="order-summary">
        <h2>Корзина</h2>
        <ul id="cart-items"></ul>
        <div class="cart-total">
            <span>Итого: </span><span id="cart-total">0 ₽</span>
        </div>
        <button id="checkout-button" class="checkout-button">Оформить заказ</button>
    </div>





<!-- Модальное окно уведомления об ошибке -->
<div id="error-modal" class="modal">
    <div class="modal-content">
        <span class="close-error-modal">&times;</span>
        <h2>Ошибка</h2>
        <p id="error-message">Пожалуйста, заполните все обязательные поля.</p>
    </div>
</div>

<div id="thank-you-message" style="display: none; background-color: #28a745; color: white; padding: 15px; position: fixed; top: 20px; right: 20px; border-radius: 5px;">
    Спасибо за покупку!
</div>




<!-- Модальное окно для ввода адреса -->
<div id="address-modal2" class="modal2">
    <div class="modal-content2">
        <span class="close-btn2" id="close-address-modal2">&times;</span>
        <h2>Укажите адрес доставки</h2>
        <form id="address-form2">
    <!-- Поле Улица -->
    <input type="text" id="street" name="street" placeholder="Улица">

    <!-- Сетка 2x2 для подъезда, квартиры, этажа и домофона -->
    <div id="matrix-container">
        <input type="text" id="entrance" name="entrance" placeholder="Подъезд">
        <input type="text" id="apartment" name="apartment" placeholder="Квартира">
        <input type="text" id="floor" name="floor" placeholder="Этаж">
        <input type="text" id="intercom" name="intercom" placeholder="Домофон">
    </div>

    <!-- Поле Комментарий на всю ширину -->
    <textarea id="comment" name="comment" rows="4" placeholder="Комментарий"></textarea>
<button type="submit2">Подтвердить</button>
</form>
    </div>
</div>


    <script>
        // Открытие модального окна при клике на иконку профиля
        document.querySelector('.header-left').addEventListener('click', function() {
            document.getElementById('profile-modal').style.display = 'block';
        });

        // Закрытие модального окна при клике на кнопку закрытия
        document.querySelector('.close-btn').addEventListener('click', function() {
            document.getElementById('profile-modal').style.display = 'none';
        });

        // Закрытие модального окна при клике вне его
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('profile-modal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        });

// Открытие модального окна для ввода адреса
document.getElementById('checkout-button').addEventListener('click', function() {
    document.getElementById('address-modal2').style.display = 'block';
});

// Закрытие модального окна
document.getElementById('close-address-modal2').addEventListener('click', function() {
    document.getElementById('address-modal2').style.display = 'none';
});










// Флаг для отслеживания состояния кнопки
    let isOrderPlaced = false;

    // Обработка формы адреса
    document.getElementById('address-form2').addEventListener('submit', function(event) {
        event.preventDefault();
//Получаем значения полей
    const street = document.getElementById('street').value.trim();
    const entrance = document.getElementById('entrance').value.trim();
    const apartment = document.getElementById('apartment').value.trim();
    const floor = document.getElementById('floor').value.trim();

        if (!street || !entrance || !apartment || !floor) {
        // Показать модальное окно ошибки
        document.getElementById('error-message').textContent = 'Пожалуйста, заполните все обязательные поля: Улица, Подъезд, Квартира, Этаж.';
        document.getElementById('error-modal').style.display = 'block';
        return; // Останавливаем дальнейшее выполнение, если есть пустые поля
    }

        // Проверка на пустые поля (сделано через required в форме)
        // Если какие-то поля не заполнены, форма не будет отправлена

        // Получаем остальные данные
        const intercom = document.getElementById('intercom').value.trim();
        const comment = document.getElementById('comment').value.trim();
// Проверяем, был ли клик вне формы
            if (!form.contains(event.target) && !addressModal.contains(event.target)) {
                document.activeElement.blur(); // Убирает фокус с активного поля ввода
            }
        // Формируем адрес для вывода
        const deliveryAddress = `Улица: ${street}, Подъезд: ${entrance}, Этаж: ${floor}, Квартира: ${apartment}, Домофон: ${intercom}, Комментарий: ${comment}`;

        // Закрываем окно ввода адреса
        document.getElementById('address-modal2').style.display = 'none';

        // Открываем корзину с товарами и адресом
        document.getElementById('view-order-button').click();

        // Выводим адрес в корзину
        const cartItemsElement = document.getElementById('cart-items');
        const addressElement = document.createElement('li');
        addressElement.textContent = `Адрес доставки: ${deliveryAddress}`;
        cartItemsElement.appendChild(addressElement);

        // Очищаем форму после успешной отправки
        document.getElementById('address-form2').reset(); // Сброс всех полей формы

        // Меняем текст кнопки
        document.getElementById('checkout-button').textContent = 'Оплатить';
        isOrderPlaced = true; // Устанавливаем флаг оформления заказа
    });

    document.getElementById('checkout-button').addEventListener('click', function() {
        if (isOrderPlaced) {
            document.getElementById('cart-items').innerHTML = '';
            document.getElementById('address-modal2').style.display = 'none';
            // Сохранить состояние успешной покупки
        localStorage.setItem('orderSuccess', 'true');
        window.location.href = 'viski.html';
            // Сброс состояния
            isOrderPlaced = false;
            this.textContent = 'Оформить заказ';
            // Скрыть уведомление через 3 секунды
            // Показать уведомление о покупке
        }

    });

document.getElementById('cart-items').innerHTML = '';
// Закрытие модального окна ошибки
document.querySelector('.close-error-modal').addEventListener('click', function() {
    document.getElementById('error-modal').style.display = 'none';
});

document.getElementById('address-modal2').style.display = 'none';













        document.addEventListener('DOMContentLoaded', function () {
            const cart = [];
            const cartItemsElement = document.getElementById('cart-items');
            const cartTotalElement = document.getElementById('cart-total');
            const orderSummaryElement = document.getElementById('order-summary');

            // Обновление содержимого корзины и бейджей количества
            function updateCart() {
                cartItemsElement.innerHTML = '';
                let total = 0;

                cart.forEach((item) => {
                    total += item.price * item.quantity;

                    const li = document.createElement('li');
                    li.textContent = `${item.name} - ${item.price} ₽ x ${item.quantity}`;
                    const removeButton = document.createElement('button');
                    removeButton.textContent = 'Удалить';
                    removeButton.onclick = () => {
                        cart.splice(cart.indexOf(item), 1);
                        updateCart();
                        updateBadge(item.name); // Обновить бейдж на карточке
                    };
                    li.appendChild(removeButton);
                    cartItemsElement.appendChild(li);
                });

                cartTotalElement.textContent = `${total} ₽`;
            }

            // Обновление бейджа количества на карточке
            function updateBadge(itemName) {
                const itemCards = document.querySelectorAll('.item-card');
                itemCards.forEach(card => {
                    if (card.querySelector('h3').textContent === itemName) {
                        const badge = card.querySelector('.item-quantity-badge');
                        const cartItem = cart.find(item => item.name === itemName);
                        const quantity = cartItem ? cartItem.quantity : 0; // Получаем количество из корзины

                        if (quantity > 0) {
                            badge.textContent = quantity;
                            badge.style.display = 'flex'; // Показываем бейдж
                        } else {
                            badge.style.display = 'none'; // Скрываем бейдж
                        }

                        // Убедимся, что кнопка уменьшения также обновляется
                        const decreaseButton = card.querySelector('.item-controls');
                        decreaseButton.style.display = quantity > 0 ? 'flex' : 'none'; // Показываем или скрываем кнопку
                    }
                });
            }

            // Уменьшение количества товара
            function decreaseQuantity(itemName) {
                const cartItem = cart.find(item => item.name === itemName);
                if (cartItem) {
                    if (cartItem.quantity > 1) {
                        cartItem.quantity -= 1;
                    } else {
                        cart.splice(cart.indexOf(cartItem), 1); // Удаляем товар, если количество равно 0
                    }
                    updateCart();
                    updateBadge(itemName); // Обновляем бейдж
                }
            }

            // Добавление товара в корзину при клике на карточку
            document.querySelectorAll('.item-card').forEach(card => {
                card.addEventListener('click', function () {
                    const itemName = card.querySelector('h3').textContent;
                    const itemPrice = parseInt(card.querySelector('p').textContent.replace('Цена: ', '').replace(' ₽', ''));

                    const cartItem = cart.find(item => item.name === itemName);
                    if (cartItem) {
                        cartItem.quantity += 1;
                    } else {
                        cart.push({ name: itemName, price: itemPrice, quantity: 1 });
                    }

                    updateCart();
                    updateBadge(itemName);
                });

                card.querySelector('.item-controls').addEventListener('click', function (event) {
                    event.stopPropagation(); // Остановить событие клика на карточке
                    const itemName = card.querySelector('h3').textContent;
                    decreaseQuantity(itemName);
                });
            });

            // Показ/скрытие корзины при нажатии кнопки View Order
            document.getElementById('view-order-button').addEventListener('click', function () {
                orderSummaryElement.style.display = orderSummaryElement.style.display === 'none' || orderSummaryElement.style.display === '' ? 'block' : 'none';
            });

            // Скрытие корзины при клике вне её области
            window.addEventListener('click', function (event) {
                const isClickInsideCart = orderSummaryElement.contains(event.target);
                const isClickViewOrderButton = document.getElementById('view-order-button').contains(event.target);
                
                // Проверка, что клик произошёл вне всех карточек
                const isClickInsideItemCards = Array.from(document.querySelectorAll('.item-card')).some(card => card.contains(event.target));

                if (!isClickInsideCart && !isClickViewOrderButton && !isClickInsideItemCards) {
                    orderSummaryElement.style.display = 'none';
                }
            });

        });




    </script>
    








<!-- <script type="text/javascript">
    // Предотвращаем действия копирования
document.addEventListener('copy', function(event) {
    event.preventDefault(); // Отменяем действие копирования
});

// Предотвращаем выделение текста при попытке выделения с помощью мыши
document.addEventListener('mousedown', function(event) {
    event.preventDefault(); // Отменяем действие выделения
});

</script> -->
 <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
    // Проверка на успешную покупку
    if (localStorage.getItem('orderSuccess')) {
        const thankYouMessage = document.getElementById('thank-you-message');
        thankYouMessage.style.display = 'block';

        // Скрыть уведомление через 3 секунды
        setTimeout(function() {
            thankYouMessage.style.display = 'none';
            // Удаляем сообщение из localStorage после отображения
            localStorage.removeItem('orderSuccess');
        }, 3000); // 3000 миллисекунд = 3 секунды
    }
});</script>




    <footer>
        <!-- <p>© 2024 Все права защищены.</p> -->
    </footer>
</body>
</html>
